<!doctype html>
<html lang="fr">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>  Some DNS Tips | Maxime SOURDIN
</title>
  <link rel="canonical" href="https://maxime.sourdin.ovh/some-dns-tips.html">


  <link rel="stylesheet" href="https://maxime.sourdin.ovh/theme/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxime.sourdin.ovh/theme/css/fontawesome.min.css">
  <link rel="stylesheet" href="https://maxime.sourdin.ovh/theme/css/pygments/default.min.css">
  <link rel="stylesheet" href="https://maxime.sourdin.ovh/theme/css/theme.css">
  <link rel="stylesheet" href="https://maxime.sourdin.ovh/theme/css/oldstyle.css">

  <link rel="alternate" type="application/atom+xml" title="Full Atom Feed"
        href="https://maxime.sourdin.ovh/feeds/all.atom.xml">
  <link rel="alternate" type="application/atom+xml" title="Categories Atom Feed"
        href="https://maxime.sourdin.ovh/feeds/network.atom.xml">  
  <meta name="description" content="Simple configuration of unbound and dnscrypt-proxy">
</head>

<body>
  <header class="header">
    <div class="container">
<div class="row">
  <div class="col-sm-12">
    <h1 class="title"><a href="https://maxime.sourdin.ovh/">Maxime SOURDIN</a></h1>
      <ul class="list-inline">
          <li class="list-inline-item"><a href="https://maxime.sourdin.ovh/cv" target="_blank">CV</a></li>
          <li class="list-inline-item"><a href="https://maxime.sourdin.ovh/cv.pdf" target="_blank">CV (PDF)</a></li>
          <li class="list-inline-item"><a href="https://linkedin.com/in/maxime-sourdin-15b082154" target="_blank">linkedin</a></li>
          <li class="list-inline-item"><a href="https://maxime.sourdin.ovh/mailto:maxime at sourdin.ovh" target="_blank">email</a></li>
          <li class="list-inline-item"><a href="https://github.com/maxime-sourdin" target="_blank">github</a></li>
          <li class="list-inline-item"><a href="https://maxime.sourdin.ovh/author/maxime-sourdin" target="_blank">blog</a></li>
      </ul>
  </div>
</div>    </div>
  </header>

  <div class="main">
    <div class="container">
      <h1>  Some DNS Tips
</h1>
  <article class="article">
    <header>
      <ul class="list-inline">
        <li class="list-inline-item text-muted" title="2022-12-11T18:00:00+01:00">
          <!-- <i class="fas fa-clock"></i>
          Dec 11, 2022 -->
        </li>
        <li class="list-inline-item">
          <i class="fas fa-folder-open"></i>
          <a href="https://maxime.sourdin.ovh/network">Network</a>
        </li>
          <li class="list-inline-item">
            <i class="fas fa-tag"></i>
              <a href="https://maxime.sourdin.ovh/tag/tips">#Tips</a>          </li>
      </ul>
    </header>
    <div class="content">
      <h1>Unbound</h1>
<h2>Edit /etc/unbound/unbound.conf</h2>
<div class="highlight"><pre><span></span><code><span class="n">server</span><span class="w"> </span><span class="o">:</span><span class="w"></span>
<span class="w">    </span><span class="n">verbosity</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="w">    </span><span class="kd">interface</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.2</span><span class="w"></span>
<span class="w">    </span><span class="kd">interface</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="k">do</span><span class="o">-</span><span class="n">ip6</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="w">    </span><span class="k">do</span><span class="o">-</span><span class="n">ip4</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="w">    </span><span class="k">do</span><span class="o">-</span><span class="n">udp</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="w">    </span><span class="k">do</span><span class="o">-</span><span class="n">tcp</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>

<span class="n">access</span><span class="w"> </span><span class="n">control</span><span class="o">:</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">1.0</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="n">allowed</span><span class="w"></span>
<span class="n">access</span><span class="w"> </span><span class="n">control</span><span class="o">:</span><span class="w"> </span><span class="o">::</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="w"> </span><span class="n">allowed</span><span class="w"></span>
<span class="n">access</span><span class="w"> </span><span class="n">control</span><span class="o">:</span><span class="w"> </span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mi">8</span><span class="w"> </span><span class="n">allowed</span><span class="w"></span>
<span class="n">access</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="n">allowed</span><span class="w"></span>

<span class="n">hide</span><span class="o">-</span><span class="n">identity</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">harden</span><span class="o">-</span><span class="n">algo</span><span class="o">-</span><span class="n">downgrade</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">no</span><span class="w"></span>
<span class="n">harden</span><span class="o">-</span><span class="n">glue</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">hide</span><span class="o">-</span><span class="n">version</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">harden</span><span class="o">-</span><span class="n">below</span><span class="o">-</span><span class="n">nxdomain</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">auto</span><span class="o">-</span><span class="n">trust</span><span class="o">-</span><span class="n">anchor</span><span class="o">-</span><span class="n">file</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;/var/lib/unbound/root.key</span>
<span class="s2">root-hints: &quot;</span><span class="sr">/var/lib/unbound/</span><span class="n">root</span><span class="o">.</span><span class="na">hints</span><span class="w"></span>
<span class="n">module</span><span class="o">-</span><span class="n">config</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;validation iterator&quot;</span><span class="o">.</span><span class="w"></span>

<span class="n">prefetch</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">prefetch</span><span class="o">-</span><span class="n">key</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">qname</span><span class="o">-</span><span class="n">minimization</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">harden</span><span class="o">-</span><span class="n">dnssec</span><span class="o">-</span><span class="n">stripped</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">use</span><span class="o">-</span><span class="n">caps</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">id</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">cache</span><span class="o">-</span><span class="n">min</span><span class="o">-</span><span class="n">ttl</span><span class="o">:</span><span class="w"> </span><span class="mi">3600</span><span class="w"></span>
<span class="n">cache</span><span class="o">-</span><span class="n">max</span><span class="o">-</span><span class="n">ttl</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">86400</span><span class="w"></span>
<span class="n">prefetch</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">num</span><span class="o">-</span><span class="n">threads</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<span class="n">msg</span><span class="o">-</span><span class="n">cache</span><span class="o">-</span><span class="n">slabs</span><span class="o">:</span><span class="w"> </span><span class="mi">16</span><span class="w"></span>
<span class="n">rrset</span><span class="o">-</span><span class="n">cache</span><span class="o">-</span><span class="n">slabs</span><span class="o">:</span><span class="w"> </span><span class="mi">16</span><span class="w"></span>
<span class="n">buffers</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">infra</span><span class="w"> </span><span class="n">caches</span><span class="o">:</span><span class="w"> </span><span class="mi">16</span><span class="w"></span>
<span class="n">buffers</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">cache</span><span class="o">:</span><span class="w"> </span><span class="mi">16</span><span class="w"></span>
<span class="n">rrset</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">size</span><span class="o">:</span><span class="w"> </span><span class="mi">256</span><span class="n">m</span><span class="w"></span>
<span class="n">msg</span><span class="w"> </span><span class="n">cache</span><span class="w"> </span><span class="n">size</span><span class="o">:</span><span class="w"> </span><span class="mi">128</span><span class="n">m</span><span class="w"></span>
<span class="n">so</span><span class="o">-</span><span class="n">rcvbuf</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="n">m</span><span class="w"></span>
<span class="n">unwanted</span><span class="o">-</span><span class="n">reply</span><span class="o">-</span><span class="n">threshold</span><span class="o">:</span><span class="w"> </span><span class="mi">10000</span><span class="w"></span>
<span class="k">do</span><span class="o">-</span><span class="n">not</span><span class="o">-</span><span class="n">query</span><span class="o">-</span><span class="n">localhost</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">val</span><span class="o">-</span><span class="n">clean</span><span class="o">-</span><span class="n">additional</span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">use</span><span class="o">-</span><span class="n">syslog</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">yes</span><span class="w"></span>
<span class="n">logfile</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="sr">/var/log/</span><span class="n">unbound</span><span class="o">.</span><span class="na">log</span><span class="w"></span>
</code></pre></div>

<h2>dnscrypt-proxy</h2>
<h3>Generate DNS STAMP</h3>
<ul>
<li>Use this site to generate the DNS STAMP of your DNS server over HTTPS](https://dnscrypt.info/stamps/)</li>
<li>Note this value, it should be included at the end of the configuration file</li>
</ul>
<h3>Edit /etc/dnscrypt-proxy/dnscrypt-proxy.toml</h3>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="c1">##############################################</span><span class="w"></span>
<span class="w">    </span><span class="c1">#                                            #</span><span class="w"></span>
<span class="w">    </span><span class="c1">#        dnscrypt-proxy configuration        #</span><span class="w"></span>
<span class="w">    </span><span class="c1">#                                            #</span><span class="w"></span>
<span class="w">    </span><span class="c1">##############################################</span><span class="w"></span>


<span class="w">    </span><span class="c1">##################################</span><span class="w"></span>
<span class="w">    </span><span class="c1">#         Global settings        #</span><span class="w"></span>
<span class="w">    </span><span class="c1">##################################</span><span class="w"></span>

<span class="w">    </span><span class="c1">## List of servers to use</span><span class="w"></span>
<span class="w">    </span><span class="c1">##</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Servers from the &quot;public-resolvers&quot; source (see down below) can</span><span class="w"></span>
<span class="w">    </span><span class="c1">## be viewed here: https://dnscrypt.info/public-servers</span><span class="w"></span>
<span class="w">    </span><span class="c1">##</span><span class="w"></span>
<span class="w">    </span><span class="c1">## The proxy will automatically pick working servers from this list.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Note that the require_* filters do NOT apply when using this setting.</span><span class="w"></span>
<span class="w">    </span><span class="c1">##</span><span class="w"></span>
<span class="w">    </span><span class="c1">## By default, this list is empty and all registered servers matching the</span><span class="w"></span>
<span class="w">    </span><span class="c1">## require_* filters will be used instead.</span><span class="w"></span>
<span class="w">    </span><span class="c1">##</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Remove the leading # first to enable this; lines starting with # are ignored.</span><span class="w"></span>

<span class="w">    </span><span class="n">server_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;sourdin&#39;</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="c1">## List of local addresses and ports to listen to. Can be IPv4 and/or IPv6.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Example with both IPv4 and IPv6:</span><span class="w"></span>
<span class="w">    </span><span class="c1">## listen_addresses = [&#39;127.0.0.1:53&#39;, &#39;[::1]:53&#39;]</span><span class="w"></span>
<span class="w">    </span><span class="c1">##</span><span class="w"></span>
<span class="w">    </span><span class="c1">## To listen to all IPv4 addresses, use `listen_addresses = [&#39;0.0.0.0:53&#39;]`</span><span class="w"></span>
<span class="w">    </span><span class="c1">## To listen to all IPv4+IPv6 addresses, use `listen_addresses = [&#39;[::]:53&#39;]`</span><span class="w"></span>
<span class="w">    </span><span class="n">listen_addresses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Maximum number of simultaneous client connections to accept</span><span class="w"></span>
<span class="w">    </span><span class="n">max_clients</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">250</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Switch to a different system user after listening sockets have been created.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Note (1): this feature is currently unsupported on Windows.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Note (2): this feature is not compatible with systemd socket activation.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Note (3): when using -pidfile, the PID file directory must be writable by the new user</span><span class="w"></span>
<span class="w">    </span><span class="c1"># user_name = &#39;nobody&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Require servers (from remote sources) to satisfy specific properties</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Use servers reachable over IPv4</span><span class="w"></span>
<span class="w">    </span><span class="n">ipv4_servers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Use servers reachable over IPv6 -- Do not enable if you don&#39;t have IPv6 connectivity</span><span class="w"></span>
<span class="w">    </span><span class="n">ipv6_servers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Use servers implementing the DNSCrypt protocol</span><span class="w"></span>
<span class="w">    </span><span class="n">dnscrypt_servers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Use servers implementing the DNS-over-HTTPS protocol</span><span class="w"></span>
<span class="w">    </span><span class="n">doh_servers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Require servers defined by remote sources to satisfy specific properties</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Server must support DNS security extensions (DNSSEC)</span><span class="w"></span>
<span class="w">    </span><span class="n">require_dnssec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Server must not log user queries (declarative)</span><span class="w"></span>
<span class="w">    </span><span class="n">require_nolog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Server must not enforce its own blocklist (for parental control, ads blocking...)</span><span class="w"></span>
<span class="w">    </span><span class="n">require_nofilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Server names to avoid even if they match all criteria</span><span class="w"></span>
<span class="w">    </span><span class="n">disabled_server_names</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Always use TCP to connect to upstream servers.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## This can be useful if you need to route everything through Tor.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Otherwise, leave this to `false`, as it doesn&#39;t improve security</span><span class="w"></span>
<span class="w">    </span><span class="c1">## (dnscrypt-proxy will always encrypt everything even using UDP), and can</span><span class="w"></span>
<span class="w">    </span><span class="c1">## only increase latency.</span><span class="w"></span>
<span class="w">    </span><span class="n">force_tcp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="w"></span>
<span class="w">    </span><span class="c1">## SOCKS proxy</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Uncomment the following line to route all TCP connections to a local Tor node</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Tor doesn&#39;t support UDP, so set `force_tcp` to `true` as well.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># proxy = &#39;socks5://127.0.0.1:9050&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## HTTP/HTTPS proxy</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Only for DoH servers</span><span class="w"></span>
<span class="w">    </span><span class="c1"># http_proxy = &#39;http://127.0.0.1:8888&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## How long a DNS query will wait for a response, in milliseconds.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## If you have a network with *a lot* of latency, you may need to</span><span class="w"></span>
<span class="w">    </span><span class="c1">## increase this. Startup may be slower if you do so.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Don&#39;t increase it too much. 10000 is the highest reasonable value.</span><span class="w"></span>
<span class="w">    </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5000</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Keepalive for HTTP (HTTPS, HTTP/2) queries, in seconds</span><span class="w"></span>
<span class="w">    </span><span class="n">keepalive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Add EDNS-client-subnet information to outgoing queries</span><span class="w"></span>
<span class="w">    </span><span class="c1">##</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Multiple networks can be listed; they will be randomly chosen.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## These networks don&#39;t have to match your actual networks.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># edns_client_subnet = [&#39;0.0.0.0/0&#39;, &#39;2001:db8::/32&#39;]</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Response for blocked queries. Options are `refused`, `hinfo` (default) or</span><span class="w"></span>
<span class="w">    </span><span class="c1">## an IP response. To give an IP response, use the format `a:&lt;IPv4&gt;,aaaa:&lt;IPv6&gt;`.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Using the `hinfo` option means that some responses will be lies.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Unfortunately, the `hinfo` option appears to be required for Android 8+</span><span class="w"></span>
<span class="w">    </span><span class="c1"># blocked_query_response = &#39;refused&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Load-balancing strategy: &#39;p2&#39; (default), &#39;ph&#39;, &#39;p&lt;n&gt;&#39;, &#39;first&#39; or &#39;random&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Randomly choose 1 of the fastest 2, half, n, 1 or all live servers by latency.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## The response quality still depends on the server itself.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># lb_strategy = &#39;p2&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Set to `true` to constantly try to estimate the latency of all the resolvers</span><span class="w"></span>
<span class="w">    </span><span class="c1">## and adjust the load-balancing parameters accordingly, or to `false` to disable.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Default is `true` that makes &#39;p2&#39; `lb_strategy` work well.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># lb_estimator = true</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Log level (0-6, default: 2 - 0 is very verbose, 6 only contains fatal errors)</span><span class="w"></span>
<span class="w">    </span><span class="c1"># log_level = 2</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Log file for the application, as an alternative to sending logs to</span><span class="w"></span>
<span class="w">    </span><span class="c1">## the standard system logging service (syslog/Windows event log).</span><span class="w"></span>
<span class="w">    </span><span class="c1">##</span><span class="w"></span>
<span class="w">    </span><span class="c1">## This file is different from other log files, and will not be</span><span class="w"></span>
<span class="w">    </span><span class="c1">## automatically rotated by the application.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># log_file = &#39;dnscrypt-proxy.log&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## When using a log file, only keep logs from the most recent launch.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># log_file_latest = true</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Use the system logger (syslog on Unix, Event Log on Windows)</span><span class="w"></span>
<span class="w">    </span><span class="c1"># use_syslog = true</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Delay, in minutes, after which certificates are reloaded</span><span class="w"></span>
<span class="w">    </span><span class="n">cert_refresh_delay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">240</span><span class="w"></span>
<span class="w">    </span><span class="c1">## DNSCrypt: Create a new, unique key for every single DNS query</span><span class="w"></span>
<span class="w">    </span><span class="c1">## This may improve privacy but can also have a significant impact on CPU usage</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Only enable if you don&#39;t have a lot of network load</span><span class="w"></span>
<span class="w">    </span><span class="c1"># dnscrypt_ephemeral_keys = false</span><span class="w"></span>
<span class="w">    </span><span class="c1">## DoH: Disable TLS session tickets - increases privacy but also latency</span><span class="w"></span>
<span class="w">    </span><span class="c1"># tls_disable_session_tickets = false</span><span class="w"></span>
<span class="w">    </span><span class="c1">## DoH: Use a specific cipher suite instead of the server preference</span><span class="w"></span>
<span class="w">    </span><span class="c1">## 49199 = TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256</span><span class="w"></span>
<span class="w">    </span><span class="c1">## 49195 = TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256</span><span class="w"></span>
<span class="w">    </span><span class="c1">## 52392 = TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305</span><span class="w"></span>
<span class="w">    </span><span class="c1">## 52393 = TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305</span><span class="w"></span>
<span class="w">    </span><span class="c1">##  4865 = TLS_AES_128_GCM_SHA256</span><span class="w"></span>
<span class="w">    </span><span class="c1">##  4867 = TLS_CHACHA20_POLY1305_SHA256</span><span class="w"></span>
<span class="w">    </span><span class="c1">##</span><span class="w"></span>
<span class="w">    </span><span class="c1">## On non-Intel CPUs such as MIPS routers and ARM systems (Android, Raspberry Pi...),</span><span class="w"></span>
<span class="w">    </span><span class="c1">## the following suite improves performance.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## This may also help on Intel CPUs running 32-bit operating systems.</span><span class="w"></span>
<span class="w">    </span><span class="c1">##</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Keep tls_cipher_suite empty if you have issues fetching sources or</span><span class="w"></span>
<span class="w">    </span><span class="c1">## connecting to some DoH servers. Google and Cloudflare are fine with it.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># tls_cipher_suite = [52392, 49199]</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Maximum time (in seconds) to wait for network connectivity before</span><span class="w"></span>
<span class="w">    </span><span class="c1">## initializing the proxy.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Useful if the proxy is automatically started at boot, and network</span><span class="w"></span>
<span class="w">    </span><span class="c1">## connectivity is not guaranteed to be immediately available.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Use 0 to not test for connectivity at all (not recommended),</span><span class="w"></span>
<span class="w">    </span><span class="c1">## and -1 to wait as much as possible.</span><span class="w"></span>
<span class="w">    </span><span class="n">netprobe_timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Address and port to try initializing a connection to, just to check</span><span class="w"></span>
<span class="w">    </span><span class="c1">## if the network is up. It can be any address and any port, even if</span><span class="w"></span>
<span class="w">    </span><span class="c1">## there is nothing answering these on the other side. Just don&#39;t use</span><span class="w"></span>
<span class="w">    </span><span class="c1">## a local address, as the goal is to check for Internet connectivity.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## On Windows, a datagram with a single, nul byte will be sent, only</span><span class="w"></span>
<span class="w">    </span><span class="c1">## when the system starts.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## On other operating systems, the connection will be initialized</span><span class="w"></span>
<span class="w">    </span><span class="c1">## but nothing will be sent at all.</span><span class="w"></span>
<span class="w">    </span><span class="n">netprobe_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;9.9.9.9:53&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Offline mode - Do not use any remote encrypted servers.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## The proxy will remain fully functional to respond to queries that</span><span class="w"></span>
<span class="w">    </span><span class="c1">## plugins can handle directly (forwarding, cloaking, ...)</span><span class="w"></span>
<span class="w">    </span><span class="c1"># offline_mode = false</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Additional data to attach to outgoing queries.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## These strings will be added as TXT records to queries.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Do not use, except on servers explicitly asking for extra data</span><span class="w"></span>
<span class="w">    </span><span class="c1">## to be present.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## encrypted-dns-server can be configured to use this for access control</span><span class="w"></span>
<span class="w">    </span><span class="c1">## in the [access_control] section</span><span class="w"></span>
<span class="w">    </span><span class="c1"># query_meta = [&#39;key1:value1&#39;, &#39;key2:value2&#39;, &#39;token:MySecretToken&#39;]</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Automatic log files rotation</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Maximum log files size in MB - Set to 0 for unlimited.</span><span class="w"></span>
<span class="w">    </span><span class="n">log_files_max_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<span class="w">    </span><span class="c1"># How long to keep backup files, in days</span><span class="w"></span>
<span class="w">    </span><span class="n">log_files_max_age</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="w">    </span><span class="c1"># Maximum log files backups to keep (or 0 to keep all backups)</span><span class="w"></span>
<span class="w">    </span><span class="n">log_files_max_backups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>

<span class="w">    </span><span class="c1">#########################</span><span class="w"></span>
<span class="w">    </span><span class="c1">#        Filters        #</span><span class="w"></span>
<span class="w">    </span><span class="c1">#########################</span><span class="w"></span>

<span class="w">    </span><span class="c1">## Note: if you are using dnsmasq, disable the `dnssec` option in dnsmasq if you</span><span class="w"></span>
<span class="w">    </span><span class="c1">## configure dnscrypt-proxy to do any kind of filtering (including the filters</span><span class="w"></span>
<span class="w">    </span><span class="c1">## below and blocklists).</span><span class="w"></span>
<span class="w">    </span><span class="c1">## You can still choose resolvers that do DNSSEC validation.</span><span class="w"></span>

<span class="w">    </span><span class="c1">## Immediately respond to IPv6-related queries with an empty response</span><span class="w"></span>
<span class="w">    </span><span class="c1">## This makes things faster when there is no IPv6 connectivity, but can</span><span class="w"></span>
<span class="w">    </span><span class="c1">## also cause reliability issues with some stub resolvers.</span><span class="w"></span>
<span class="w">    </span><span class="n">block_ipv6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">false</span><span class="w"></span>
<span class="w">    </span><span class="c1">## TTL for synthetic responses sent when a request has been blocked (due to</span><span class="w"></span>
<span class="w">    </span><span class="c1">## IPv6 or blocklists).</span><span class="w"></span>

<span class="w">    </span><span class="n">reject_ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<span class="w">    </span><span class="c1">##################################################################################</span><span class="w"></span>
<span class="w">    </span><span class="c1">#        Route queries for specific domains to a dedicated set of servers        #</span><span class="w"></span>
<span class="w">    </span><span class="c1">##################################################################################</span><span class="w"></span>

<span class="w">    </span><span class="c1">## See the `example-forwarding-rules.txt` file for an example</span><span class="w"></span>
<span class="w">    </span><span class="c1"># forwarding_rules = &#39;forwarding-rules.txt&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">###############################</span><span class="w"></span>
<span class="w">    </span><span class="c1">#        Cloaking rules       #</span><span class="w"></span>
<span class="w">    </span><span class="c1">###############################</span><span class="w"></span>

<span class="w">    </span><span class="c1">## Cloaking returns a predefined address for a specific name.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## In addition to acting as a HOSTS file, it can also return the IP address</span><span class="w"></span>
<span class="w">    </span><span class="c1">## of a different name. It will also do CNAME flattening.</span><span class="w"></span>
<span class="w">    </span><span class="c1">## If &#39;cloak_ptr&#39; is set, then PTR (reverse lookups) are enabled</span><span class="w"></span>
<span class="w">    </span><span class="c1">## for cloaking rules that do not contain wild cards.</span><span class="w"></span>
<span class="w">    </span><span class="c1">##</span><span class="w"></span>
<span class="w">    </span><span class="c1">## See the `example-cloaking-rules.txt` file for an example</span><span class="w"></span>
<span class="w">    </span><span class="c1"># cloaking_rules = &#39;cloaking-rules.txt&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## TTL used when serving entries in cloaking-rules.txt</span><span class="w"></span>
<span class="w">    </span><span class="c1"># cloak_ttl = 600</span><span class="w"></span>
<span class="w">    </span><span class="c1"># cloak_ptr = false</span><span class="w"></span>
<span class="w">    </span><span class="c1">###########################</span><span class="w"></span>
<span class="w">    </span><span class="c1">#        DNS cache        #</span><span class="w"></span>
<span class="w">    </span><span class="c1">###########################</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Enable a DNS cache to reduce latency and outgoing traffic</span><span class="w"></span>
<span class="w">    </span><span class="n">cache</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">true</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Cache size</span><span class="w"></span>
<span class="w">    </span><span class="n">cache_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4096</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Minimum TTL for cached entries</span><span class="w"></span>
<span class="w">    </span><span class="n">cache_min_ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2400</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Maximum TTL for cached entries</span><span class="w"></span>
<span class="w">    </span><span class="n">cache_max_ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">86400</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Minimum TTL for negatively cached entries</span><span class="w"></span>
<span class="w">    </span><span class="n">cache_neg_min_ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">60</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Maximum TTL for negatively cached entries</span><span class="w"></span>
<span class="w">    </span><span class="n">cache_neg_max_ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">600</span><span class="w"></span>

<span class="w">    </span><span class="c1">###############################</span><span class="w"></span>
<span class="w">    </span><span class="c1">#        Query logging        #</span><span class="w"></span>
<span class="w">    </span><span class="c1">###############################</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Log client queries to a file</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">query_log</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Path to the query log file (absolute, or relative to the same directory as the config file)</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Can be set to /dev/stdout in order to log to the standard output.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># file = &#39;query.log&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Query log format (currently supported: tsv and ltsv)</span><span class="w"></span>
<span class="w">    </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tsv&#39;</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Do not log these query types, to reduce verbosity. Keep empty to log everything.</span><span class="w"></span>
<span class="w">    </span><span class="c1"># ignored_qtypes = [&#39;DNSKEY&#39;, &#39;NS&#39;]</span><span class="w"></span>

<span class="w">    </span><span class="c1">########################################</span><span class="w"></span>
<span class="w">    </span><span class="c1">#            Static entries            #</span><span class="w"></span>
<span class="w">    </span><span class="c1">########################################</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Optional, local, static list of additional servers</span><span class="w"></span>
<span class="w">    </span><span class="c1">## Mostly useful for testing your own servers.</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="k">static</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="k">static</span><span class="o">.</span><span class="s1">&#39;sourdin&#39;</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="n">stamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"></span>
</code></pre></div>
    </div>
  </article>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
<div class="row">
  <ul class="col-sm-6 list-inline">
  </ul>
  <p class="col-sm-6 text-sm-right text-muted">
    Generated by <a href="https://github.com/getpelican/pelican" target="_blank">Pelican</a>
    / <a href="https://github.com/nairobilug/pelican-alchemy" target="_blank">&#x2728;</a>
  </p>
</div>    </div>
  </footer>

</body>
</html>